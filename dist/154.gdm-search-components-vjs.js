(self.webpackChunkgdm_search_components_vjs=self.webpackChunkgdm_search_components_vjs||[]).push([[154],{154:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>b});var o=s(4783),n=s(9264),a=s.n(n),r=s(535),i=s.n(r),c=s(4802),l=s.n(c),u=s(5093),d=s.n(u);const p={name:"GdmStatForm",props:{mode:{type:String,default:"connection"},services:{type:Array,default:function(){return[]}},groups:{type:Object,default:function(){}}},watch:{mode:function(t){this.search()}},computed:{selectedName:function(){var t=this;if(""!==this.selectedService){var e=this.services.find((function(e){return e.id===t.selectedService}));if(e)return"Jobs pour le service "+e.name}return""!==this.selectedGroup?"Jobs pour les services "+this.selectedGroup:"Jobs pour tous les services"}},data:function(){return{by:"day",startDate:null,endDate:null,group:"type",groupBy:"service",status:"",selectedService:"",selectedServices:[],selectedGroup:"",userType:null}},created:function(){this.by="day",this.startDate=d()().startOf("month").format("YYYY-MM-DD"),this.endDate=d()().endOf("month").format("YYYY-MM-DD"),this.selectedServices=this.services,this.search()},methods:{details:function(){var t={};if(this.startDate&&(t.startDate=this.startDate),this.endDate&&(t.endDate=this.endDate),""!==this.status&&(t.status=this.status),""!==this.selectedService)t.service=this.selectedService;else if(""!==this.selectedGroup){var e=this.selectedServices.map((function(t){return t.id}));t.service=e.join(",")}return t.groupBy=this.groupBy,this.group&&(t.group=this.group),t.by=this.by,t},search:function(){this.$emit("search",this.details())},changeGroup:function(){""!==this.selectedGroup?(this.selectedService="",this.selectedServices=this.groups[this.selectedGroup]):this.selectedServices=this.services,this.$emit("servicesChange",this.selectedServices),this.search()},draw:function(){this.$emit("draw",this.details())}}};var v=s(4486);const h=(0,v.A)(p,(function(){var t=this,e=t._self._c;return e("span",[e("div",{staticStyle:{"margin-left":"20px"}},["service"!==t.mode?e("div",{staticClass:"user-search",class:{"user-search-large":"job"===t.mode||"product"===t.mode||"ciest2"===t.mode}},[e("label",[t._v("Du")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.startDate,expression:"startDate"}],attrs:{type:"date"},domProps:{value:t.startDate},on:{change:function(e){return t.search()},input:function(e){e.target.composing||(t.startDate=e.target.value)}}}),t._v(" "),e("label",[t._v("au")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.endDate,expression:"endDate"}],attrs:{type:"date"},domProps:{value:t.endDate},on:{change:function(e){return t.search()},input:function(e){e.target.composing||(t.endDate=e.target.value)}}}),t._v(" "),e("label",[t._v("Par")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.by,expression:"by"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.by=e.target.multiple?s:s[0]},function(e){return t.draw()}]}},[e("option",{attrs:{value:"day"}},[t._v("Jour")]),t._v(" "),e("option",{attrs:{value:"month"}},[t._v("Mois")]),t._v(" "),e("option",{attrs:{value:"year"}},[t._v("Year")])]),t._v(" "),"connection"===t.mode?e("span",[e("label",[t._v("Par")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.group,expression:"group"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.group=e.target.multiple?s:s[0]},function(e){return t.draw()}]}},[e("option",{attrs:{value:"type"}},[t._v("Type d'utilisateur")]),t._v(" "),e("option",{attrs:{value:"pole"}},[t._v("Pôle de données")])])]):t._e(),t._v(" "),"job"===t.mode||"ciest2"===t.mode?e("span",[e("label",[t._v("Statut")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.status,expression:"status"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.status=e.target.multiple?s:s[0]},function(e){return t.search()}]}},[e("option",{attrs:{value:""}},[t._v("---")]),t._v(" "),e("option",{attrs:{value:"RUNNING"}},[t._v("EN COURS...")]),t._v(" "),e("option",{attrs:{value:"ended"}},[t._v("TERMINÉ")]),t._v(" "),e("option",{attrs:{value:"SUCCESS"}},[t._v("Terminé avec succès")]),t._v(" "),e("option",{attrs:{value:"FAILED"}},[t._v("Terminé en échec")]),t._v(" "),e("option",{attrs:{value:"ABORTED"}},[t._v("Terminé par abandon")])])]):t._e(),t._v(" "),"job"===t.mode||"product"===t.mode||"ciest2"===t.mode?e("span",[e("label",[t._v("Groupe")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedGroup,expression:"selectedGroup"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectedGroup=e.target.multiple?s:s[0]},function(e){return t.changeGroup()}]}},[e("option",{attrs:{value:""}},[t._v("TOUS")]),t._v(" "),t._l(t.groups,(function(s,o){return e("option",{domProps:{value:o}},[t._v("\n            "+t._s(o)+"\n         ")])}))],2),t._v(" "),e("label",[t._v("Service")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedService,expression:"selectedService"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectedService=e.target.multiple?s:s[0]},function(e){return t.search()}]}},[e("option",{attrs:{value:""}},[t._v("TOUS")]),t._v(" "),t._l(t.selectedServices,(function(s){return e("option",{domProps:{value:s.id}},[t._v("\n            "+t._s(s.name)+"\n         ")])}))],2)]):t._e(),t._v(" "),"job"===t.mode||"ciest2"===t.mode?e("span",[e("label",[t._v("Regrouper par")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.groupBy,expression:"groupBy"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.groupBy=e.target.multiple?s:s[0]},function(e){return t.search()}]}},[e("option",{attrs:{value:"service"}},[t._v("Service")]),t._v(" "),e("option",{attrs:{value:"status"}},[t._v("Statut")]),t._v(" "),e("option",{attrs:{value:"type"}},[t._v("Type d'organisme")]),t._v(" "),e("option",{attrs:{value:"pole"}},[t._v("Pôle de données")])])]):t._e()]):t._e()])])}),[],!1,null,null,null).exports,_={name:"StatProcessSummary",props:{colors:{type:Array,default:function(){return[]}},groupBy:{type:String,default:"service"},userTypes:{type:Array,default:function(){return[]}},poles:{type:Array,default:function(){return[]}},status:{type:Array,default:function(){return[]}},selectedName:{type:String,default:""},selectedService:{type:String,default:""},selectedServices:{type:Array,default:function(){return[]}},jobs:{type:Object,default:null}},methods:{secondToStr:function(t){t=Math.round(t);var e=Math.floor(t/86400);t%=86400;var s=Math.floor(t/3600);t%=3600;var o=Math.floor(t/60),n=t%60;return(e>0?e+"j ":"")+s.toString().padStart(2,"0")+":"+o.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")},poleName:function(t){var e=this.poles.find((function(e){return e.po_id===t}));return e?e.po_name?e.po_name:e.po_description.fr:"inconnu"}}},f=(0,v.A)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"job-header"},[e("div",[e("h2",[t._v("Total jobs")]),t._v(" "),t._l(t.userTypes,(function(s,o){return"type"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:t.colors[o]}}),t._v(" "),e("b",[t._v(t._s(s.t_name_fr))]),t._v(":\n         "),t.jobs.count&&t.jobs.count[s.t_id]?e("span",[t._v(t._s(t.jobs.count[s.t_id].toLocaleString()))]):e("span",[t._v("0")])]):t._e()})),t._v(" "),t._l(t.poles,(function(s,o){return"pole"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.po_color}}),t._v(" "),e("b",[t._v(t._s(t.poleName(s.po_id)))]),t._v(":\n         "),t.jobs.count&&t.jobs.count[s.po_id]?e("span",[t._v(t._s(t.jobs.count[s.po_id].toLocaleString()))]):e("span",[t._v("0")])]):t._e()})),t._v(" "),t._l(t.status,(function(s,o){return"status"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n         "),t.jobs.count&&t.jobs.count[s.id]?e("span",[t._v(t._s(t.jobs.count[s.id].toLocaleString()))]):e("span",[t._v("0")])]):t._e()})),t._v(" "),t._l(t.selectedServices,(function(s){return"service"!==t.groupBy||""!==t.selectedService&&t.selectedService!==s.id?t._e():e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n         "),t.jobs.count&&t.jobs.count[s.name]?e("span",[t._v(t._s(t.jobs.count[s.name].toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),""===t.selectedService||"service"!==t.groupBy?e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}):t._e(),t._v(" "),""===t.selectedService||"service"!==t.groupBy?e("div",[e("b",[t._v("Total")]),t._v(": "+t._s(t.jobs.avg.count)+"\n       ")]):t._e()],2),t._v(" "),e("div",[e("h2",[t._v("Coût moyen")]),t._v(" "),t._l(t.userTypes,(function(s,o){return"type"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:t.colors[o]}}),t._v(" "),e("b",[t._v(t._s(s.t_name_fr))]),t._v(":\n         "),t.jobs.cost&&t.jobs.cost[s.t_id]?e("span",[t._v(t._s(Math.round(t.jobs.cost[s.t_id]/t.jobs.countCost[s.t_id]).toLocaleString())+" CPU secondes")]):e("span",[t._v("---")])]):t._e()})),t._v(" "),t._l(t.poles,(function(s,o){return"pole"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.po_color}}),t._v(" "),e("b",[t._v(t._s(t.poleName(s.po_id)))]),t._v(":\n         "),t.jobs.cost&&t.jobs.cost[s.po_id]?e("span",[t._v(t._s(Math.round(t.jobs.cost[s.po_id]/t.jobs.countCost[s.po_id]).toLocaleString())+" CPU secondes")]):e("span",[t._v("---")])]):t._e()})),t._v(" "),t._l(t.status,(function(s,o){return"status"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n         "),t.jobs.cost&&t.jobs.cost[s.id]?e("span",[t._v(t._s(Math.round(t.jobs.cost[s.id]/t.jobs.countCost[s.id]).toLocaleString())+" CPU secondes")]):e("span",[t._v("---")])]):t._e()})),t._v(" "),t._l(t.selectedServices,(function(s){return"service"!==t.groupBy||""!==t.selectedService&&t.selectedService!==s.id?t._e():e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n         "),t.jobs.cost&&t.jobs.cost[s.name]?e("span",[t._v(t._s(Math.round(t.jobs.cost[s.name]/t.jobs.countCost[s.name]).toLocaleString())+" CPU secondes")]):e("span",[t._v("---")])])})),t._v(" "),""===t.selectedService||"service"!==t.groupBy?e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}):t._e(),t._v(" "),""===t.selectedService||"service"!==t.groupBy?e("div",[e("b",[t._v("Tout "+t._s(t.groupBy))]),t._v(":\n          "),t.jobs.avg&&t.jobs.avg.cost?e("span",[t._v(t._s(Math.round(t.jobs.avg.cost).toLocaleString())+" CPU Secondes")]):e("span",[t._v("---")])]):t._e()],2),t._v(" "),e("div",[e("h2",[t._v("Durée moyenne")]),t._v(" "),t._l(t.userTypes,(function(s,o){return"type"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:t.colors[o]}}),t._v(" "),e("b",[t._v(t._s(s.t_name_fr))]),t._v(":\n         "),t.jobs.duration[s.t_id]&&t.jobs.countDuration[s.t_id]?e("span",[t._v(t._s(t.secondToStr(t.jobs.duration[s.t_id]/t.jobs.countDuration[s.t_id])))]):e("span",[t._v("---")])]):t._e()})),t._v(" "),t._l(t.poles,(function(s,o){return"pole"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.po_color}}),t._v(" "),e("b",[t._v(t._s(t.poleName(s.po_id)))]),t._v(":\n         "),t.jobs.duration[s.po_id]&&t.jobs.countDuration[s.po_id]?e("span",[t._v(t._s(t.secondToStr(t.jobs.duration[s.po_id]/t.jobs.countDuration[s.po_id])))]):e("span",[t._v("---")])]):t._e()})),t._v(" "),t._l(t.status,(function(s,o){return"status"===t.groupBy?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n         "),t.jobs.duration[s.id]&&t.jobs.countDuration[s.id]?e("span",[t._v(t._s(t.secondToStr(t.jobs.duration[s.id]/t.jobs.countDuration[s.id])))]):e("span",[t._v("---")])]):t._e()})),t._v(" "),t._l(t.selectedServices,(function(s){return"service"!==t.groupBy||""!==t.selectedService&&t.selectedService!==s.id?t._e():e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n         "),t.jobs.duration[s.name]&&t.jobs.countDuration[s.name]?e("span",[t._v(t._s(t.secondToStr(t.jobs.duration[s.name]/t.jobs.countDuration[s.name])))]):e("span",[t._v("---")])])})),t._v(" "),""===t.selectedService||"service"!==t.groupBy?e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}):t._e(),t._v(" "),""===t.selectedService||"service"!==t.groupBy?e("div",[e("b",[t._v("Tout "+t._s(t.groupBy))]),t._v(":\n          "),t.jobs.avg.duration?e("span",[t._v(t._s(t.secondToStr(t.jobs.avg.duration)))]):e("span",[t._v("---")])]):t._e()],2)])}),[],!1,null,null,null).exports;function m(t,e,s){return(e=function(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var s=e.call(t,"string");if("object"!=y(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}"object"===y(o)&&(a()(o),l()(o),i()(o));const g={name:"GdmStat",components:{GdmStatForm:h,StatProcessSummary:f},props:{appUrl:{type:String,default:null}},computed:{},data:function(){return m(m({startDate:null,endDate:null,by:"day",mode:"service",group:"type",groupBy:"service",serviceUsers:[],userTypes:[],poles:[],days:[],months:[],years:[],services:[],selectedServices:[],groups:{},sessions:null,newUsers:null,jobs:null,products:null,ciest2:null,download:null,status:"",totalUsers:0,disabledUsers:0},"status",[{id:"RUNNING",name:"En cours",color:"grey"},{id:"SUCCESS",name:"Terminé avec succès",color:"green"},{id:"ABORTED",name:"Abandonné",color:"orange"},{id:"FAILED",name:"En échec",color:"red"}]),"colors",["#2f7ed8","#910000","#8bbc21","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a","#0d233a"])},created:function(){this.getClassification(),this.sessions={type:this.defaultData(),pole:this.defaultData()},this.newUsers={type:this.defaultData(),pole:this.defaultData()},this.jobs=this.defaultData(),this.products=this.defaultData(),this.ciest2=this.defaultData(),this.download=this.jobs=this.defaultData()},methods:{defaultData:function(){return{data:{days:{},months:{},years:{}},count:{},cost:{},countCost:{},duration:{},countDuration:{},countJobs:{},avg:{}}},selectedName:function(){return this.$refs&&this.$refs.form?this.$refs.form.selectedName:""},selectedService:function(){return this.$refs&&this.$refs.form?this.$refs.form.selectedService:""},initServices:function(t){this.selectedServices=t},nameByKey:function(t,e){return"pole"===e?this.poleName(t):this.userTypeName(t)},poleName:function(t){var e=this.poles.find((function(e){return e.po_id===t}));return e?e.po_name?e.po_name:e.po_description.fr:"inconnu"},userTypeName:function(t){var e=this.userTypes.find((function(e){return e.t_id===t}));if(e)return e.t_name_fr},draw:function(t){switch(this.group=t.group,this.mode){case"connection":this.drawConnection(t),this.drawNewUsers(t);break;case"services":this.drawServices(t);break;case"job":this.drawJobs(t);break;case"product":this.drawProducts(t);break;case"ciest2":this.drawCiest2(t),this.drawDownload(t)}},drawHistogram:function(t,e,s,n,a){var r=this.colors;a&&a.colors&&(r=a.colors),o.chart(t,{chart:{type:"column"},title:{text:e,align:"left",style:{color:"#000000",fontSize:"20px",fontWeight:700}},credits:{enabled:!1},colors:r,legend:{labelFormatter:function(){return this.name}},subtitle:{text:""},xAxis:{categories:s,crosshair:!0},yAxis:{min:0,allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(t){var e=0,s="<b>"+this.x.replaceAll("-","/")+"</b><br />";return this.points.forEach((function(t,o){s+='<span style="color: '+t.color+'">●</span> '+n[o].name+": "+t.y+"<br/>",e+=t.y})),s+'<span style="margin-left:10px;font-weight:700">Total: </span>'+e},shared:!0,useHTML:!0},plotOptions:{column:{stacking:"normal",pointPadding:0,borderWidth:1,groupPadding:0,shadow:!1}},series:n})},drawPie:function(t,e,s,n){var a=this.colors;n.colors&&(a=n.colors),o.chart(t,{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:e},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},accessibility:{point:{valueSuffix:"%"}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",colors:a,dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %"}}},series:s})},drawNewUsers:function(t){var e=this[t.by+"s"],s=this.newUsers[t.group].data[t.by+"s"],o=[],n={};for(var a in s)if(o.push({name:this.nameByKey(a,t.group),data:s[a]}),"pole"===t.group){n.colors||(n.colors=[]);var r=this.poles.find((function(t){return t.po_id===a}));n.colors.push(r.po_color)}this.drawHistogram("newUsers","Histogramme des Nouveaux comptes",e,o,n)},drawConnection:function(t){var e=this[t.by+"s"],s=this.sessions[t.group].data[t.by+"s"],o=[],n={};for(var a in s)if(o.push({name:this.nameByKey(a,t.group),data:s[a]}),"pole"===t.group){n.colors||(n.colors=[]);var r=this.poles.find((function(t){return t.po_id===a}));n.colors.push(r.po_color)}this.drawHistogram("sessions","Histogramme de connexions",e,o,n)},drawJobs:function(t){var e=this[t.by+"s"],s=this.jobs.data[t.by+"s"],o=[],n=[],a="";for(var r in s){switch(t.groupBy){case"pole":var i=this.poles.find((function(t){return t.po_id===r}));n.push(i.po_color);case"type":a=this.nameByKey(r,t.groupBy);break;case"status":i=this.status.find((function(t){return t.id===r})),n.push(i.color),a=i.name;break;case"service":var c=this.services.find((function(t){return t.name===r}));a=r,n.push(c.color)}o.push({name:a,data:s[r]})}var l={};n.length>0&&(l={colors:n}),this.drawHistogram("jobs","Nombre de jobs",e,o,l)},drawProducts:function(t){var e=this[t.by+"s"],s=this.products.data[t.by+"s"],o=[],n=[],a="";for(var r in s){var i=this.services.find((function(t){return t.name===r}));a=r,n.push(i.color),o.push({name:a,data:s[r]})}var c={};n.length>0&&(c={colors:n}),this.drawHistogram("products","Nombre de produits",e,o,c)},drawCiest2:function(t){var e=this[t.by+"s"],s=this.ciest2.data[t.by+"s"],o=[],n=[],a="";for(var r in s){switch(t.groupBy){case"pole":var i=this.poles.find((function(t){return t.po_id===r}));n.push(i.po_color);case"type":a=this.nameByKey(r,t.groupBy);break;case"status":i=this.status.find((function(t){return t.id===r})),n.push(i.color),a=i.name;break;case"service":var c=this.services.find((function(t){return t.name===r}));a=r,n.push(c.color)}o.push({name:a,data:s[r]})}var l={};n.length>0&&(l={colors:n}),this.drawHistogram("ciest2","Activité CIEST2",e,o,l)},drawDownload:function(t){var e=this[t.by+"s"],s=this.download.data[t.by+"s"],o=[];o.push({name:"Téléchargements",data:s}),this.drawHistogram("download","Téléchargement FTP",e,o,{})},getServices:function(){var t=this.appUrl+"/api/services/list";this.$http.get(t).then((function(t){this.services=t.body.services,this.selectedServices=this.services;var e=this;this.services.forEach((function(t){e.groups[t.group]?e.groups[t.group].push(t):e.groups[t.group]=[t]}))}))},getClassification:function(){var t=this.appUrl+"/api/users/types?full=yes";this.$http.get(t,{headers:{"Accept-Language":"fr"}}).then((function(t){this.initialize(t.body)}))},initialize:function(t){t.types&&(this.userTypes=t.types,this.poles=t.poles),this.getServices()},average:function(t,e){var s=0,o=0,n=0,a=0,r=0;switch(e){case"type":this.userTypes.forEach((function(e){s+=t.count[e.t_id],n+=t.countDuration[e.t_id],o+=t.duration[e.t_id],a+=t.cost[e.t_id],r+=t.countCost[e.t_id]}));break;case"pole":this.poles.forEach((function(e){s+=t.count[e.po_id],n+=t.countDuration[e.po_id],o+=t.duration[e.po_id],a+=t.cost[e.po_id],r+=t.countCost[e.po_id]}));break;case"status":this.status.forEach((function(e){s+=t.count[e.id],n+=t.countDuration[e.id],o+=t.duration[e.id],a+=t.cost[e.id],r+=t.countCost[e.id]}));break;default:this.selectedServices.forEach((function(e){s+=t.count[e.name],n+=t.countDuration[e.name],o+=t.duration[e.name],a+=t.cost[e.name],r+=t.countCost[e.name]}))}t.avg={count:s,cost:r>0?Math.round(a/r):0,duration:n>0?Math.round(o/n):0}},productsAverage:function(t){var e=this,s=0,o=0;this.selectedServices.forEach((function(t){o+=e.products.countJobs[t.name],s+=e.products.count[t.name]})),this.products.avg={countJobs:o,countProducts:s}},secondToStr:function(t){t=Math.round(t);var e=Math.floor(t/86400);t%=86400;var s=Math.floor(t/3600);t%=3600;var o=Math.floor(t/60),n=t%60;return(e>0?e+"j ":"")+s.toString().padStart(2,"0")+":"+o.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")},setMode:function(t){this.mode=t},search:function(t){if(this.appUrl)switch(this.mode){case"connection":this.searchConnection(t);break;case"service":this.searchService(t);break;case"job":this.searchJob(t);break;case"product":this.searchProduct(t);break;case"ciest2":this.searchCiest2(t)}},searchConnection:function(t){var e=this.appUrl+"/api/statistics/sessions?",s=[];t.startDate&&s.push("start="+t.startDate),t.endDate&&s.push("end="+t.endDate),e+=s.join("&"),this.$http.get(e,{credentials:!0}).then((function(e){this.treatmentConnection(e.body,t)}))},searchJob:function(t){var e=this.appUrl+"/api/statistics/process?",s=[];t.startDate&&s.push("start="+t.startDate),t.endDate&&s.push("end="+t.endDate),t.status&&s.push("status="+t.status),t.service&&s.push("serviceIds="+t.service),t.groupBy&&s.push("groupBy="+t.groupBy),e+=s.join("&"),this.$http.get(e,{credentials:!0}).then((function(e){this.jobs=this.treatmentJobs(e.body,t),this.average(this.jobs,t.groupBy,t),this.drawJobs(t)}))},searchProduct:function(t){var e=this.appUrl+"/api/statistics/products?",s=[];t.startDate&&s.push("start="+t.startDate),t.endDate&&s.push("end="+t.endDate),t.service&&s.push("service="+t.service),e+=s.join("&"),this.$http.get(e,{credentials:!0}).then((function(e){this.treatmentProducts(e.body,t)}))},searchService:function(){this.$http.get(this.appUrl+"/api/statistics/users",{credentials:!0}).then((function(t){this.treatmentServices(t.body)}))},searchCiest2:function(t){var e=this.appUrl+"/api/statistics/ciest?",s=[];t.startDate&&s.push("start="+t.startDate),t.endDate&&s.push("end="+t.endDate),""!==this.status&&s.push("status="+t.status),t.groupBy&&s.push("groupBy="+t.groupBy),e+=s.join("&"),this.$http.get(e,{credentials:!0}).then((function(e){this.ciest2=this.treatmentJobs(e.body,t),this.download.data=this.extractSeriesFrom(e.body.download,null,this.download,!1,t),this.average(this.ciest2,t.groupBy,t),this.drawCiest2(t),this.drawDownload(t)}))},extractSeriesFrom:function(t,e,s,o,n){o&&(this.days=[],this.months=[],this.years=[],e&&(s.cost={},s.count={},s.countCost={},s.duration={},s.countDuration={},s.countJobs={})),e?(s.count[e]=0,s.cost[e]=0,s.countCost[e]=0,s.duration[e]=0,s.countDuration[e]=0,s.countJobs[e]=0):(s.count=0,s.cost=0,s.countCost=0,s.duration=0,s.countDuration=0,s.countJobs=0);var a=d()(n.startDate,"YYYY-MM-DD"),r={days:[],months:[],years:[]},i=(a=d()(n.startDate,"YYYY-MM-DD"),this),c=a.year(),l=(a.month()+1).toString().padStart(2,"0")+"-"+c,u=null,p=null;o&&(this.years.push(c+""),this.months.push(l));var v=0,h=0;t.forEach((function(t){var n=t.year.toString()+t.month.toString().padStart(2,"0")+t.day.toString().padStart(2,"0"),_=d()(n,"YYYYMMDD");for(u=_.year(),p=(_.month()+1).toString().padStart(2,"0")+"-"+u;_.diff(a,"days")>0;)o&&i.days.push(a.format("DD-MM-YYYY")),r.days.push(0),a.add(1,"days"),u=a.year(),(p=(a.month()+1).toString().padStart(2,"0")+"-"+u)!==l&&(r.months.push(v),o&&i.months.push(p),l=p,v=0),u!==c&&(r.years.push(h),o&&i.years.push(u+""),c=u,h=0);o&&i.days.push(a.format("DD-MM-YYYY")),r.days.push(t.tot),e?s.count[e]=s.count[e]+t.tot:s.count=s.count+t.tot,t.cost&&e&&(s.cost[e]=s.cost[e]+t.cost,s.countCost[e]=s.countCost[e]+t.tot),t.count&&e&&(s.countJobs[e]=s.countJobs[e]+t.count),t.duration&&e&&(s.duration[e]=s.duration[e]+parseInt(t.duration),s.countDuration[e]=s.countDuration[e]+t.tot),v+=t.tot,h+=t.tot,p!==l&&(r.months.push(v),o&&i.months.push(p),l=p,v=0),u!==c&&(r.years.push(h),o&&i.years.push(u+""),c=u,h=0),a=_.add(1,"days")}));for(var _=d()(n.endDate,"YYYY-MM-DD");_.diff(a,"days")>=0;)o&&i.days.push(a.format("DD-MM-YYYY")),r.days.push(0),u=a.year(),(p=(a.month()+1).toString().padStart(2,"0")+"-"+u)!==l&&(r.months.push(v),o&&i.months.push(p),l=p,v=0),u!==c&&(r.years.push(h),o&&i.years.push(u+""),c=u,h=0),a.add(1,"days");return this.years.length>r.years.length&&r.years.push(h),this.months.length>r.months.length&&r.months.push(v),r},treatmentConnection:function(t,e){var s=this,o=!0;this.userTypes.forEach((function(n){var a=t.sessionByType.filter((function(t){return t.type===n.t_id})),r=s.extractSeriesFrom(a,n.t_id,s.sessions.type,o,e);o=!1,s.sessions.type.data.days[n.t_id]=r.days,s.sessions.type.data.months[n.t_id]=r.months,s.sessions.type.data.years[n.t_id]=r.years})),this.average(this.sessions.type,"type"),this.poles.forEach((function(n){var a=t.sessionByPole.filter((function(t){return t.pole===n.po_id})),r=s.extractSeriesFrom(a,n.po_id,s.sessions.pole,o,e);o=!1,s.sessions.pole.data.days[n.po_id]=r.days,s.sessions.pole.data.months[n.po_id]=r.months,s.sessions.pole.data.years[n.po_id]=r.years})),this.average(this.sessions.pole,"pole"),this.drawConnection(e),this.userTypes.forEach((function(o){var n=t.newUserByType.filter((function(t){return t.type===o.t_id})),a=s.extractSeriesFrom(n,o.t_id,s.newUsers.type,!1,e);s.newUsers.type.data.days[o.t_id]=a.days,s.newUsers.type.data.months[o.t_id]=a.months,s.newUsers.type.data.years[o.t_id]=a.years})),this.average(this.newUsers.type,"type"),this.poles.forEach((function(n){var a=t.newUserByPole.filter((function(t){return t.pole===n.po_id})),r=s.extractSeriesFrom(a,n.po_id,s.newUsers.pole,o,e);o=!1,s.newUsers.pole.data.days[n.po_id]=r.days,s.newUsers.pole.data.months[n.po_id]=r.months,s.newUsers.pole.data.years[n.po_id]=r.years})),this.average(this.newUsers.pole,"pole"),this.drawNewUsers(e)},treatmentJobs:function(t,e){this.groupBy=e.groupBy;var s=this,o=this.defaultData(),n=!0;switch(e.groupBy){case"type":this.userTypes.forEach((function(a){var r=t.process.filter((function(t){return t.type===a.t_id})),i=s.extractSeriesFrom(r,a.t_id,o,n,e);n=!1,o.data.days[a.t_id]=i.days,o.data.months[a.t_id]=i.months,o.data.years[a.t_id]=i.years}));break;case"status":this.status.forEach((function(a){var r=t.process.filter((function(t){return a.id===t.status})),i=s.extractSeriesFrom(r,a.id,o,n,e);n=!1,o.data.days[a.id]=i.days,o.data.months[a.id]=i.months,o.data.years[a.id]=i.years}));break;case"pole":this.poles.forEach((function(a){var r=t.process.filter((function(t){return t.pole===a.po_id})),i=s.extractSeriesFrom(r,a.po_id,o,n,e);n=!1,o.data.days[a.po_id]=i.days,o.data.months[a.po_id]=i.months,o.data.years[a.po_id]=i.years}));break;case"service":console.log(this.selectedServices),this.selectedServices.forEach((function(a){if(""===s.selectedService()||s.selectedService()===a.id){var r=t.process.filter((function(t){return t.service===parseInt(a.id)})),i=s.extractSeriesFrom(r,a.name,o,n,e);n=!1,o.data.days[a.name]=i.days,o.data.months[a.name]=i.months,o.data.years[a.name]=i.years}}))}return o},treatmentProducts:function(t,e){this.products.data={days:{},months:{},years:{}};var s=!0,o=this;this.selectedServices.forEach((function(n){if(""===o.selectedService()||o.selectedService()===n.id){var a=t.products.filter((function(t){return t.service===parseInt(n.id)})),r=o.extractSeriesFrom(a,n.name,o.products,s,e);s=!1,o.products.data.days[n.name]=r.days,o.products.data.months[n.name]=r.months,o.products.data.years[n.name]=r.years}})),this.productsAverage(e),this.drawProducts(e)},treatmentServices:function(t){var e=this,s=0,o=0;t.types.forEach((function(t){t.type?s+=t.tot:o+=t.tot})),this.totalUsers=s,this.disabledUsers=o;var n=0,a=[];this.userTypes.forEach((function(o,r,i){var c=t.types.find((function(t){return t.type===o.t_id}));n=c?Math.round(100*c.tot/s):0,a.push({name:e.userTypeName(o.t_id),y:n})}));var r={name:"truc",data:a};this.drawPie("userByType","Utilisateurs par type d'organisme",[r],{}),s=0,t.poles.forEach((function(t){t.pole&&(s+=t.tot)})),n=0,a=[],u=[],this.poles.forEach((function(o,r,i){var c=t.poles.find((function(t){return t.pole===o.po_id}));n=c?Math.round(100*c.tot/s):0,u.push(o.po_color),a.push({name:e.poleName(o.po_id),y:n})})),r={name:"truc",data:a},this.drawPie("userByPole","Utilisateurs par pôle",[r],{colors:u});var i=null,c=[],l={},u=[];this.poles.forEach((function(t){l[t.po_id]=[],u.push(t.po_color)})),t.servicePoles.forEach((function(e){if(e.service!==i)for(var s in c.push(e.service),i=e.service,l){var o=t.servicePoles.find((function(t){return t.pole===s&&t.service===i}));o?l[s].push(o.tot):l[s].push(0)}}));var d=[];for(var p in l)d.push({name:this.poleName(p),data:l[p]});for(var v in this.drawHistogram("servicePoles","Nombre d'utilisateurs par service et par pôle",c,d,{colors:u}),i=null,c=[],l={},this.userTypes.forEach((function(t){l[t.t_id]=[]})),console.log(l),t.serviceTypes.forEach((function(e){if(e.service!==i)for(var s in c.push(e.service),i=e.service,l){var o=t.serviceTypes.find((function(t){return t.type===s&&t.service===i}));o?l[s].push(o.tot):l[s].push(0)}})),d=[],l)d.push({name:this.userTypeName(v),data:l[v]});this.drawHistogram("serviceUsers","Nombre d'utilisateurs par service et type",c,d)}}};s(9263);const b=(0,v.A)(g,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{padding:"10px"}},[e("ul",{staticClass:"menu-content"},[e("li",{class:{selected:"service"===t.mode},on:{click:function(e){return t.setMode("service")}}},[e("span",[t._v("Services")])]),e("li",{class:{selected:"connection"===t.mode},on:{click:function(e){return t.setMode("connection")}}},[e("span",[t._v("Connexion")])]),e("li",{class:{selected:"job"===t.mode},on:{click:function(e){return t.setMode("job")}}},[e("span",[t._v("Jobs")])]),e("li",{class:{selected:"product"===t.mode},on:{click:function(e){return t.setMode("product")}}},[e("span",[t._v("Produits")])]),e("li",{class:{selected:"ciest2"===t.mode},on:{click:function(e){return t.setMode("ciest2")}}},[e("span",[t._v("CIEST2")])])])]),t._v(" "),e("gdm-stat-form",{ref:"form",attrs:{mode:t.mode,services:t.services,groups:t.groups},on:{servicesChange:t.initServices,search:t.search,draw:t.draw}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"connection"===t.mode,expression:"mode === 'connection'"}]},[e("h1",[t._v("Suivi des authentifications")]),t._v(" "),"type"===t.group?e("div",{staticClass:"job-header"},[e("div",[e("h2",[t._v("Total connexions aux services de calcul par type d'organisme")]),t._v(" "),t._l(t.userTypes,(function(s,o){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:t.colors[o]}}),t._v(" "),e("b",[t._v(t._s(s.t_name_fr))]),t._v(":\n\t             "),t.sessions.type.count&&t.sessions.type.count[s.t_id]?e("span",[t._v(t._s(t.sessions.type.count[s.t_id].toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s(t.sessions.type.avg.count)+"\n           ")])],2),t._v(" "),e("div",[e("h2",[t._v("Visiteurs par jour")]),t._v(" "),t._l(t.userTypes,(function(s,o){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:t.colors[o]}}),t._v(" "),e("b",[t._v(t._s(s.t_name_fr))]),t._v(":\n               "),t.sessions.type.count&&t.sessions.type.count[s.t_id]?e("span",[t._v(t._s((t.sessions.type.count[s.t_id]/t.days.length).toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s((t.sessions.type.avg.count/t.days.length).toLocaleString())+"\n           ")])],2)]):e("div",{staticClass:"job-header"},[e("div",[e("h2",[t._v("Total connexions aux services de calcul par pôle")]),t._v(" "),t._l(t.poles,(function(s,o){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.po_color}}),t._v(" "),e("b",[t._v(t._s(t.poleName(s.po_id)))]),t._v(":\n               "),t.sessions.pole.count&&t.sessions.pole.count[s.po_id]?e("span",[t._v(t._s(t.sessions.pole.count[s.po_id].toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s(t.sessions.pole.avg.count)+"\n           ")])],2),t._v(" "),e("div",[e("h2",[t._v("Visiteurs par jour")]),t._v(" "),t._l(t.poles,(function(s,o){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.po_color}}),t._v(" "),e("b",[t._v(t._s(t.poleName(s.po_id)))]),t._v(":\n               "),t.sessions.pole.count&&t.sessions.pole.count[s.po_id]?e("span",[t._v(t._s((t.sessions.pole.count[s.po_id]/t.days.length).toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s((t.sessions.pole.avg.count/t.days.length).toLocaleString())+"\n           ")])],2)]),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"},attrs:{id:"sessions"}}),t._v(" "),e("h1",[t._v("Suivi des créations de comptes")]),t._v(" "),"type"===t.group?e("div",{staticClass:"job-header"},[e("div",[e("h2",[t._v("Total nouvels utilisateurs")]),t._v(" "),t._l(t.userTypes,(function(s,o){return t.userTypes?e("div",[e("span",{staticClass:"fa fa-circle",style:{color:t.colors[o]}}),t._v(" "),e("b",[t._v(t._s(s.t_name_fr))]),t._v(":\n               "),t.newUsers.type.count&&t.newUsers.type.count[s.t_id]?e("span",[t._v(t._s(t.newUsers.type.count[s.t_id].toLocaleString()))]):e("span",[t._v("0")])]):t._e()})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s(t.newUsers.type.avg.count)+"\n           ")])],2),t._v(" "),e("div",[e("h2",[t._v("Nouveaux comptes par jour")]),t._v(" "),t._l(t.userTypes,(function(s,o){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:t.colors[o]}}),t._v(" "),e("b",[t._v(t._s(s.t_name_fr))]),t._v(":\n               "),t.newUsers.type.count&&t.newUsers.type.count[s.t_id]?e("span",[t._v(t._s((t.newUsers.type.count[s.t_id]/t.days.length).toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s((t.newUsers.type.avg.count/t.days.length).toLocaleString())+"\n           ")])],2)]):e("div",{staticClass:"job-header"},[e("div",[e("h2",[t._v("Total nouvels utilisateurs")]),t._v(" "),t._l(t.poles,(function(s,o){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.po_color}}),t._v(" "),e("b",[t._v(t._s(t.poleName(s.po_id)))]),t._v(":\n               "),t.newUsers.pole.count&&t.newUsers.pole.count[s.po_id]?e("span",[t._v(t._s(t.newUsers.pole.count[s.po_id].toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s(t.newUsers.pole.avg.count)+"\n           ")])],2),t._v(" "),e("div",[e("h2",[t._v("Nouveaux comptes par jour")]),t._v(" "),t._l(t.poles,(function(s,o){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.po_color}}),t._v(" "),e("b",[t._v(t._s(t.poleName(s.po_id)))]),t._v(":\n               "),t.newUsers.pole.count&&t.newUsers.pole.count[s.po_id]?e("span",[t._v(t._s((t.newUsers.pole.count[s.po_id]/t.days.length).toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}),t._v(" "),e("div",[e("b",[t._v("Total")]),t._v(": "+t._s((t.newUsers.pole.avg.count/t.days.length).toLocaleString())+"\n           ")])],2)]),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"},attrs:{id:"newUsers"}})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"service"===t.mode,expression:"mode === 'service'"}]},[e("h2",[t._v("Répartition des utilisateurs")]),t._v(" "),e("div",[e("b",[t._v("Nombre d'utilisateurs actifs")]),t._v(": "+t._s(t.totalUsers))]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"},attrs:{id:"serviceUsers"}}),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"},attrs:{id:"servicePoles"}})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"job"===t.mode,expression:"mode === 'job'"}],staticClass:"job-content"},[e("h1",[t._v(t._s(t.selectedName()))]),t._v(" "),e("stat-process-summary",{attrs:{colors:t.colors,"selected-name":t.selectedName(),"selected-service":t.selectedService(),"group-by":t.groupBy,"selected-services":t.selectedServices,"user-types":t.userTypes,poles:t.poles,status:t.status,jobs:t.jobs}}),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"},attrs:{id:"jobs"}})],1),t._v(" "),"product"===t.mode?e("div",[e("h1",[t._v(t._s(t.selectedName()))]),t._v(" "),e("div",{staticClass:"job-header"},[e("div",[e("h2",[t._v("Nombre de jobs")]),t._v(" "),t._l(t.selectedServices,(function(s){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n             "),t.products.countJobs&&t.products.countJobs[s.name]?e("span",[t._v(t._s(t.products.countJobs[s.name].toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),""===t.selectedService()?e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}):t._e(),t._v(" "),""===t.selectedService()?e("div",[e("b",[t._v("Total")]),t._v(": "+t._s(t.products.avg.countJobs)+"\n           ")]):t._e()],2),t._v(" "),e("div",[e("h2",[t._v("Total produits générés")]),t._v(" "),t._l(t.selectedServices,(function(s){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n             "),t.products.countJobs&&t.products.countJobs[s.name]?e("span",[t._v(t._s(t.products.count[s.name].toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),""===t.selectedService()?e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}):t._e(),t._v(" "),""===t.selectedService()?e("div",[e("b",[t._v("Total")]),t._v(": "+t._s(t.products.avg.countProducts)+"\n           ")]):t._e()],2),t._v(" "),e("div",[e("h2",[t._v("Nombre moyen de produits générés")]),t._v(" "),t._l(t.selectedServices,(function(s){return e("div",[e("span",{staticClass:"fa fa-circle",style:{color:s.color}}),t._v(" "),e("b",[t._v(t._s(s.name))]),t._v(":\n             "),t.products.countJobs&&t.products.countJobs[s.name]?e("span",[t._v(t._s((t.products.count[s.name]/t.products.countJobs[s.name]).toLocaleString()))]):e("span",[t._v("0")])])})),t._v(" "),""===t.selectedService()?e("hr",{staticStyle:{width:"60%","margin-left":"5px",color:"gray"}}):t._e(),t._v(" "),""===t.selectedService()?e("div",[e("b",[t._v("Total")]),t._v(": \n              "),t.products.avg.countJobs?e("span",[t._v(t._s(Math.round(t.products.avg.countProducts/t.products.avg.countJobs).toLocaleString()))]):e("span",[t._v("---")])]):t._e()],2)]),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"},attrs:{id:"products"}})]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"ciest2"===t.mode,expression:"mode === 'ciest2'"}],staticClass:"job-content"},[e("h1",[t._v(t._s(t.selectedName()))]),t._v(" "),e("stat-process-summary",{attrs:{colors:t.colors,"selected-name":t.selectedName(),"selected-service":t.selectedService(),"group-by":t.groupBy,"selected-services":t.selectedServices,"user-types":t.userTypes,poles:t.poles,status:t.status,jobs:t.ciest2}}),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"},attrs:{id:"ciest2"}}),t._v(" "),e("div",{staticStyle:{"margin-top":"30px"}},[e("h1",[t._v("Images téléchargées")]),t._v(" "),e("div",{staticClass:"job-header"},[e("h2",[t._v("Total: "+t._s(t.download.count))])]),t._v(" "),e("div",{attrs:{id:"download"}})])],1)],1)}),[function(){var t=this._self._c;return t("div",{staticStyle:{width:"48%",display:"inline-block","margin-top":"30px"}},[t("div",{attrs:{id:"userByType"}})])},function(){var t=this._self._c;return t("div",{staticStyle:{width:"48%",display:"inline-block"}},[t("div",{attrs:{id:"userByPole"}})])}],!1,null,null,null).exports},535:(t,e,s)=>{var o,n,a;a=function(t){"use strict";var e=t?t._modules:{};function s(e,s,o,n){e.hasOwnProperty(s)||(e[s]=n.apply(null,o),"function"==typeof CustomEvent&&t.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:s,module:e[s]}})))}s(e,"Extensions/DownloadURL.js",[e["Core/Globals.js"]],(function(t){let{isSafari:e,win:s,win:{document:o}}=t,n=s.URL||s.webkitURL||s;function a(t){let e=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(e&&e.length>3&&s.atob&&s.ArrayBuffer&&s.Uint8Array&&s.Blob&&n.createObjectURL){let t=s.atob(e[3]),o=new s.ArrayBuffer(t.length),a=new s.Uint8Array(o);for(let e=0;e<a.length;++e)a[e]=t.charCodeAt(e);return n.createObjectURL(new s.Blob([a],{type:e[1]}))}}return{dataURLtoBlob:a,downloadURL:function(t,n){let r=s.navigator,i=o.createElement("a");if("string"!=typeof t&&!(t instanceof String)&&r.msSaveOrOpenBlob)return void r.msSaveOrOpenBlob(t,n);if(t=""+t,r.userAgent.length>1e3)throw Error("Input too long");let c=/Edge\/\d+/.test(r.userAgent);if((e&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||c||t.length>2e6)&&!(t=a(t)||""))throw Error("Failed to convert to blob");if(void 0!==i.download)i.href=t,i.download=n,o.body.appendChild(i),i.click(),o.body.removeChild(i);else try{if(!s.open(t,"chart"))throw Error("Failed to open window")}catch{s.location.href=t}}}})),s(e,"Extensions/ExportData/ExportDataDefaults.js",[],(function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0,showExportInProgress:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table",exportInProgress:"Exporting..."}}})),s(e,"Extensions/ExportData/ExportData.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Defaults.js"],e["Extensions/DownloadURL.js"],e["Extensions/ExportData/ExportDataDefaults.js"],e["Core/Globals.js"],e["Core/Utilities.js"]],(function(t,e,s,o,n,a){let{getOptions:r,setOptions:i}=e,{downloadURL:c}=s,{doc:l,win:u}=n,{addEvent:d,defined:p,extend:v,find:h,fireEvent:_,isNumber:f,pick:m}=a;function y(t){let e=!!this.options.exporting?.showExportInProgress,s=u.requestAnimationFrame||setTimeout;s((()=>{e&&this.showLoading(this.options.lang.exportInProgress),s((()=>{try{t.call(this)}finally{e&&this.hideLoading()}}))}))}function g(){y.call(this,(()=>{let t=this.getCSV(!0);c(U(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")}))}function b(){y.call(this,(()=>{let t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";c(U(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+u.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")}))}function x(t){let e="",s=this.getDataRows(),o=this.options.exporting.csv,n=m(o.decimalPoint,","!==o.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),a=m(o.itemDelimiter,","===n?";":","),r=o.lineDelimiter;return s.forEach(((t,o)=>{let i="",c=t.length;for(;c--;)"string"==typeof(i=t[c])&&(i=`"${i}"`),"number"==typeof i&&"."!==n&&(i=i.toString().replace(".",n)),t[c]=i;t.length=s.length?s[0].length:0,e+=t.join(a),o<s.length-1&&(e+=r)})),e}function S(t){let e,s,o,n,a,r,i,c=this.hasParallelCoordinates,l=this.time,u=this.options.exporting&&this.options.exporting.csv||{},d=this.xAxis,v={},y=[],g=[],b=[],x=this.options.lang.exportData,S=x.categoryHeader,w=x.categoryDatetimeHeader,D=function(e,s,o){if(u.columnHeaderFormatter){let t=u.columnHeaderFormatter(e,s,o);if(!1!==t)return t}return e?e.bindAxes?t?{columnTitle:o>1?s:e.name,topLevelColumnTitle:e.name}:e.name+(o>1?" ("+s+")":""):e.options.title&&e.options.title.text||(e.dateTime?w:S):S},T=function(t,e,s){let o={},n={};return e.forEach((function(e){let a=(t.keyToAxis&&t.keyToAxis[e]||e)+"Axis",r=f(s)?t.chart[a][s]:t[a];o[e]=r&&r.categories||[],n[e]=r&&r.dateTime})),{categoryMap:o,dateTimeValueAxisMap:n}},j=[],C=0;for(r in this.series.forEach((function(e){let s,o,n=e.options.keys,r=e.xAxis,i=n||function(t,e){let s=t.pointArrayMap||["y"];return t.data.some((t=>void 0!==t.y&&t.name))&&e&&!e.categories&&"name"!==t.exportKey?["x",...s]:s}(e,r),p=i.length,_=!e.requireSorting&&{},f=d.indexOf(r),y=T(e,i);if(!1!==e.options.includeInDataExport&&!e.options.isInternal&&!1!==e.visible){for(h(j,(function(t){return t[0]===f}))||j.push([f,C]),o=0;o<p;)a=D(e,i[o],i.length),b.push(a.columnTitle||a),t&&g.push(a.topLevelColumnTitle||a),o++;s={chart:e.chart,autoIncrement:e.autoIncrement,options:e.options,pointArrayMap:e.pointArrayMap,index:e.index},e.options.data.forEach((function(t,n){let a,d,h,g={series:s};c&&(y=T(e,i,n)),e.pointClass.prototype.applyOptions.apply(g,[t]);let b=e.data[n]&&e.data[n].name;if(a=(g.x??"")+","+b,o=0,(!r||"name"===e.exportKey||!c&&r&&r.hasNames&&b)&&(a=b),_&&(_[a]&&(a+="|"+n),_[a]=!0),v[a]){let t=`${a},${v[a].pointers[e.index]}`,s=a;v[a].pointers[e.index]&&(v[t]||(v[t]=[],v[t].xValues=[],v[t].pointers=[]),a=t),v[s].pointers[e.index]+=1}else{v[a]=[],v[a].xValues=[];let t=[];for(let s=0;s<e.chart.series.length;s++)t[s]=0;v[a].pointers=t,v[a].pointers[e.index]=1}for(v[a].x=g.x,v[a].name=b,v[a].xValues[f]=g.x;o<p;)h=g[d=i[o]],v[a][C+o]=m(y.categoryMap[d][h],y.dateTimeValueAxisMap[d]?l.dateFormat(u.dateFormat,h):null,h),o++})),C+=o}})),v)Object.hasOwnProperty.call(v,r)&&y.push(v[r]);for(n=t?[g,b]:[b],C=j.length;C--;)e=j[C][0],s=j[C][1],o=d[e],y.sort((function(t,s){return t.xValues[e]-s.xValues[e]})),i=D(o),n[0].splice(s,0,i),t&&n[1]&&n[1].splice(s,0,i),y.forEach((function(t){let e=t.name;o&&!p(e)&&(o.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),e=l.dateFormat(u.dateFormat,t.x)):e=o.categories?m(o.names[t.x],o.categories[t.x],t.x):t.x),t.splice(s,0,e)}));return _(this,"exportData",{dataRows:n=n.concat(y)}),n}function w(t){let e=t=>{if(!t.tagName||"#text"===t.tagName)return t.textContent||"";let s=t.attributes,o=`<${t.tagName}`;return s&&Object.keys(s).forEach((t=>{let e=s[t];o+=` ${t}="${e}"`})),o+=">"+(t.textContent||""),(t.children||[]).forEach((t=>{o+=e(t)})),o+=`</${t.tagName}>`};return e(this.getTableAST(t))}function D(t){let e=0,s=[],o=this.options,n=t?1.1.toLocaleString()[1]:".",a=m(o.exporting.useMultiLevelHeaders,!0),r=this.getDataRows(a),i=a?r.shift():null,c=r.shift(),l=function(t,e,s,o){let a=m(o,""),r="highcharts-text"+(e?" "+e:"");return"number"==typeof a?(a=a.toString(),","===n&&(a=a.replace(".",n)),r="highcharts-number"):o||(r="highcharts-empty"),{tagName:t,attributes:s=v({class:r},s),textContent:a}};!1!==o.exporting.tableCaption&&s.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:m(o.exporting.tableCaption,o.title.text?o.title.text:"Chart")});for(let t=0,s=r.length;t<s;++t)r[t].length>e&&(e=r[t].length);s.push(function(t,e,s){let n,r,i=[],c=0,u=s||e&&e.length,d=0;if(a&&t&&e&&!function(t,e){let s=t.length;if(e.length!==s)return!1;for(;s--;)if(t[s]!==e[s])return!1;return!0}(t,e)){let s=[];for(;c<u;++c)if((n=t[c])===t[c+1])++d;else if(d)s.push(l("th","highcharts-table-topheading",{scope:"col",colspan:d+1},n)),d=0;else{n===e[c]?o.exporting.useRowspanHeaders?(r=2,delete e[c]):(r=1,e[c]=""):r=1;let t=l("th","highcharts-table-topheading",{scope:"col"},n);r>1&&t.attributes&&(t.attributes.valign="top",t.attributes.rowspan=r),s.push(t)}i.push({tagName:"tr",children:s})}if(e){let t=[];for(c=0,u=e.length;c<u;++c)void 0!==e[c]&&t.push(l("th",null,{scope:"col"},e[c]));i.push({tagName:"tr",children:t})}return{tagName:"thead",children:i}}(i,c,Math.max(e,c.length)));let u=[];r.forEach((function(t){let s=[];for(let o=0;o<e;o++)s.push(l(o?"td":"th",null,o?{}:{scope:"row"},t[o]));u.push({tagName:"tr",children:s})})),s.push({tagName:"tbody",children:u});let d={tree:{tagName:"table",id:`highcharts-data-table-${this.index}`,children:s}};return _(this,"aftergetTableAST",d),d.tree}function T(){this.toggleDataTable(!1)}function j(e){let s=(e=m(e,!this.isDataTableVisible))&&!this.dataTableDiv;if(s&&(this.dataTableDiv=l.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){let o=this.dataTableDiv.style,n=o.display;o.display=e?"block":"none",e?(this.dataTableDiv.innerHTML=t.emptyHTML,new t([this.getTableAST()]).addToDOM(this.dataTableDiv),_(this,"afterViewData",{element:this.dataTableDiv,wasHidden:s||n!==o.display})):_(this,"afterHideData")}this.isDataTableVisible=e;let o=this.exportDivElements,n=this.options.exporting,a=n&&n.buttons&&n.buttons.contextButton.menuItems,r=this.options.lang;if(n&&n.menuItemDefinitions&&r&&r.viewData&&r.hideData&&a&&o){let e=o[a.indexOf("viewData")];e&&t.setElementHTML(e,this.isDataTableVisible?r.hideData:r.viewData)}}function C(){this.toggleDataTable(!0)}function U(t,e){let s=u.navigator,o=u.URL||u.webkitURL||u;try{if(s.msSaveOrOpenBlob&&u.MSBlobBuilder){let e=new u.MSBlobBuilder;return e.append(t),e.getBlob("image/svg+xml")}return o.createObjectURL(new u.Blob(["\ufeff"+t],{type:e}))}catch(t){}}function E(){let t=this,e=t.dataTableDiv,s=(t,e)=>t.children[e].textContent,o=(t,e)=>(o,n)=>{let a,r;return a=s(e?o:n,t),r=s(e?n:o,t),""===a||""===r||isNaN(a)||isNaN(r)?a.toString().localeCompare(r):a-r};if(e&&t.options.exporting&&t.options.exporting.allowTableSorting){let s=e.querySelector("thead tr");s&&s.childNodes.forEach((s=>{let n=s.closest("table");s.addEventListener("click",(function(){let a=[...e.querySelectorAll("tr:not(thead tr)")],r=[...s.parentNode.children];a.sort(o(r.indexOf(s),t.ascendingOrderInTable=!t.ascendingOrderInTable)).forEach((t=>{n.appendChild(t)})),r.forEach((t=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach((e=>{t.classList.contains(e)&&t.classList.remove(e)}))})),s.classList.add(t.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")}))}))}}function B(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}function N(){this.dataTableDiv?.remove()}return{compose:function(t,e){let s=t.prototype;if(!s.getCSV){let n=r().exporting;d(t,"afterViewData",E),d(t,"render",B),d(t,"destroy",N),s.downloadCSV=g,s.downloadXLS=b,s.getCSV=x,s.getDataRows=S,s.getTable=w,s.getTableAST=D,s.hideData=T,s.toggleDataTable=j,s.viewData=C,n&&(v(n.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){y.call(this,this.toggleDataTable)}}}),n.buttons&&n.buttons.contextButton.menuItems&&n.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),i(o);let{arearange:a,gantt:c,map:l,mapbubble:u,treemap:p,xrange:h}=e.types;a&&(a.prototype.keyToAxis={low:"y",high:"y"}),c&&(c.prototype.exportKey="name",c.prototype.keyToAxis={start:"x",end:"x"}),l&&(l.prototype.exportKey="name"),u&&(u.prototype.exportKey="name"),p&&(p.prototype.exportKey="name"),h&&(h.prototype.keyToAxis={x2:"x"})}}}})),s(e,"masters/modules/export-data.src.js",[e["Core/Globals.js"],e["Extensions/DownloadURL.js"],e["Extensions/ExportData/ExportData.js"]],(function(t,e,s){return t.dataURLtoBlob=t.dataURLtoBlob||e.dataURLtoBlob,t.downloadURL=t.downloadURL||e.downloadURL,s.compose(t.Chart,t.Series),t}))},t.exports?(a.default=a,t.exports=a):(o=[s(4783),s(9264)],void 0===(n=function(t){return a(t),a.Highcharts=t,a}.apply(e,o))||(t.exports=n))},5340:(t,e,s)=>{(e=s(6314)(!1)).push([t.id,'\n.job-header {\n  display:flex;\n}\n.job-header > div {\n  padding: 0 10px 0 0;\n  flex-grow:1;\n}\n.job-header h2,\n.job-content h1 {\n  color:black;\n  font-size:20px;\n  font-family: "Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif;\n}\n.job-content h1 {\n  font-size: 24px;\n}\n.user-search {\n   margin:auto;\n   margin-bottom:20px;\n   text-align: left;\n   display: inline-block;\n   background: #F5f5f5;\n   margin-bottom: 40px;\n   margin-left: calc(50% - 225px);\n   padding: 10px;\n   border: 1px solid grey;\n   border-radius: 5px;\n}\n.user-search-large {\n   margin-left:5px;\n}\n.user-search > div {\n   display: inline-block;\n}\n.user-search label {\n   margin-left:10px;\n   font-weight: 700;\n}\nul.menu-content {\n  border-bottom: 1px solid #adadad;\n}\nul.menu-content li {\n  display: inline-block;\n\tmin-width: 50px;\n\tfont-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n\tborder: 1px solid #adadad;\n\tborder-bottom: none;\n\ttext-align: center;\n\tcolor: black;\n\theight: 30px;\n\tvertical-align: middle;\n\tmargin: 0;\n\tbackground: #efefef;\n\tcursor:pointer;\n}\nul.menu-content li span {\n   text-transform: capitalize;\nvertical-align: middle;\nfont-size: 1.1rem;\nheight: 30px;\nmin-width: 50px;\ncolor: black;\npadding: 5px 10px 0 10px;\ntext-decoration: none;\ndisplay: inline-block;\n}\n/* ul.menu-content li{\n    text-transform: capitalize;\n    vertical-align: middle;\n    font-size: 1.1rem;\n    height: 30px;\n    min-width:50px;\n    color:black;\n    padding: 5px 10px 0 10px;\n    text-decoration: none;\n    display:inline-block;\n} */\nul.menu-content li:hover {\n  color:#b8412c;\n}\nul.menu-content li.selected  span {\n  background:white;\n  color:#b8412c;\n}\nul.menu-content li.isDisabled {\n  pointer-events: none;\n  color:grey;\n}\n',""]),t.exports=e},9263:(t,e,s)=>{var o=s(5340);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals),(0,s(534).A)("688fd28c",o,!0,{})}}]);
//# sourceMappingURL=154.gdm-search-components-vjs.js.map