(self.webpackChunkgdm_search_components_vjs=self.webpackChunkgdm_search_components_vjs||[]).push([[157],{8665:e=>{L.Control.Fullscreen=L.Control.extend({options:{position:"topright"},_large:null,_nodeSmall:null,_nodeLarge:null,_mapContainer:null,_lang:"en",_removeHeight:400,_fullscreen:!1,_mouseWheel:!1,_translate:{en:{fullscreen:"Enlarge",reduce:"Reduce"},fr:{fullscreen:"Agrandir",reduce:"Reduire"}},initialize:function(e,t){this._large=e,t.lang&&this.setLang(t.lang),t.hasOwnProperty("removeHeight")&&null!==t.removeHeight&&this.setRemoveHeight(t.removeHeight),t.mouseWheel&&(this._mouseWheel=t.mouseWheel)},setLang(e){this._lang=["en","fr"].indexOf(e)>=0?e:"en"},setRemoveHeight(e){this._removeHeight=e},onAdd:function(e){if(this._nodeSmall=e._container.parentNode,this._nodeLarge=document.querySelector("#"+this._large),this._nodeLarge){var t=L.DomUtil.create("div","leaflet-bar leaflet-control lfh-control-fullscreen"),i=L.DomUtil.create("a","fa fa-expand");i.setAttribute("title",this._translate[this._lang].fullscreen),t.appendChild(i);var s=this;return i.onclick=function(e){s._fullscreen=!s._fullscreen,this.setAttribute("class",s._fullscreen?"fa fa-compress":"fa fa-expand"),s._fullscreen?s._enlarge(e):s._reduce(e)},t}},_enlarge:function(e){this._nodeLarge.appendChild(this._map._container),this._nodeLarge.style.display="block";var t=window.innerHeight-this._removeHeight;this._container.querySelector("a").setAttribute("title",this._translate[this._lang].reduce),this._map._container.style.height=t+"px",this._map._container.className=this._map._container.className.replace("mtdt-small","mtdt-fullscreen"),this._map.setMinZoom(2),this._mouseWheel&&this._map.scrollWheelZoom.enable(),this._map.invalidateSize(),this._emitChange(),e.stopPropagation()},_reduce:function(e){this._nodeLarge.style.display="none",this._nodeSmall.appendChild(this._map._container),this._map.setMinZoom(1),this._map._container.className=this._map._container.className.replace("mtdt-fullscreen","mtdt-small"),this._map.invalidateSize(),this._map.scrollWheelZoom.disable(),this._emitChange(),e.stopPropagation()},_emitChange:function(){var e=new CustomEvent("mapNodeChange");document.dispatchEvent(e)}}),e.exports=L.Control.Fullscreen},4221:e=>{L.Control.Legend=L.Control.extend({options:{position:"topright"},_legend:null,_legends:null,_imgNode:null,_lang:"en",_toId:null,_translate:{en:{legend:"Legend"},fr:{legend:"LÃ©gende"}},initialize:function(e,t){this.setLang(e),this._legends=new Map,this._toId=t},setLang(e){this._lang=["en","fr"].indexOf(e)>=0?e:"en"},addLegend(e,t,i){this._legends.has(e)||this._legends.set(e,new Map),this._legends.get(e).has(t)||(this._legends.get(e).set(t,i),this._addLegendToDom(t,i)),this.currentUuid=e},removeLegend(e){this._removeLegendFromDom(e),this._legends.has(this.currentUuid)&&this._legends.get(this.currentUuid).delete(e)},back(e){var t=this._legends.keys(),i=null,s=null;for(var l of t)s=i,i=l;if(i){for(var n of this._legends.get(i).keys())this._removeLegendFromDom(n);this._legends.delete(i)}if(this.currentUuid=e,s&&s===e)for(var[n,o]of this._legends.get(s))this._addLegendToDom(n,o)},removeAll(){this._legends.forEach((function(e){e.clear()})),this._legends.clear(),this._container.querySelectorAll("img").forEach((function(e){e.parentNode.removeChild(e)}))},onAdd:function(e){var t=L.DomUtil.create("div","leaflet-bar leaflet-control lfh-control-legend hidden"),i=L.DomUtil.create("a","icon-palette");return i.setAttribute("title",this._translate[this._lang].legend),t.appendChild(i),t.onclick=function(){this.className.indexOf("expand")>=0?this.classList.remove("expand"):this.classList.add("expand")},t},_removeLegendFromDom(e){var t=this._container.querySelector("#"+this._toId(e));t&&t.parentNode.removeChild(t),this._container.childNodes.length<2&&this._container.classList.add("hidden")},_addLegendToDom(e,t){var i=document.createElement("img");i.src=t,i.id=this._toId(e),this._container.appendChild(i),this._container.childNodes.length>=2&&this._container.classList.remove("hidden")}}),e.exports=L.Control.Legend},739:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var s=i(5243),l=i(381),n=i.n(l),o=i(538),r=i(4104);o.ZP.use(r.ZP);const a={root:null,lines:0,columns:0,tileLines:0,tileCols:0,tile:{lines:100,columns:100},url:{ew:null,ns:null},tabs:["ns","ew"],tiles:{},determinant:null,coordSystem:{origin:null,u:null,v:null},parent:null,active:null,images:[],initialize(e){this.extractTileUrl(e),this.computeCoordSystem(e)},extractTileUrl(e){var t=/(^https?:\/\/.*_)[0-9]{3}_[0-9]{3}\.json$/,i=t.exec(e.properties.tiles.ew[0]);i&&(this.url.ew=i[1]),(i=t.exec(e.properties.tiles.ns[0]))&&(this.url.ns=i[1])},initializeTile(e,t,i){this.tiles[e]||(this.tiles[e]={}),this.tiles[e][t]||(this.tiles[e][t]=i.data),!this.tiles[e].loaded&&this.tiles[e].ns&&this.tiles[e].ew&&(this.tiles[e].loaded=!0,this.searchValidPoints(e,"ns"))},searchValidPoints(e,t){var i=[];this.tiles[e][t].forEach((function(e,t){e.forEach((function(e,t){null!==e[3]&&i.push({pt:[e[0],e[1]],value:e[3]})}))})),this.parent&&0===this.images.length&&this.parent.addMarkers(i)},load(e,t){console.log("load = "+e),this.parent=t,this._root=e;var i=e.split("/");i.pop();var s=i.join("/");return this.dir=s+"/",this.dir,new Promise(((t,i)=>{o.ZP.http.get(e).then((e=>{this.initialize(e.body),t(e.body)}),(e=>i(e)))}))},loadAll(e,t){if(!(e>this.tileLines)){var i=this,s=e.toString().padStart(3,"0")+"_"+t.toString().padStart(3,"0");this.loadTile("ns",s).then((e=>i.loadTile("ew",s))).then((l=>{for(var n=s;i.tiles[n]&&i.tiles[n].loaded;)t<i.tileCols?t++:(e++,t=0),n=e.toString().padStart(3,"0")+"_"+t.toString().padStart(3,"0");i.loadAll(e,t)}))}},loadTile(e,t){var i=this;return new Promise(((s,l)=>!1===t?(l&&l(),!1):i.tiles[t]&&i.tiles[t].loaded?(s&&s(),!0):void(i.url[e]&&o.ZP.http.get(i.url[e]+t+".json").then((l=>{i.initializeTile(t,e,l.body),s&&s()})))))},changeFrame(e,t){var i=(this.coordSystem.u.dLng*(e-this.coordSystem.origin.lat)-this.coordSystem.u.dLat*(t-this.coordSystem.origin.lng))/this.determinant,s=(this.coordSystem.v.dLat*(t-this.coordSystem.origin.lng)-this.coordSystem.v.dLng*(e-this.coordSystem.origin.lat))/this.determinant;if(i>this.lines||i<0)return{tile:!1};if(s>this.columns||s<0)return{tile:!1};var l={line:Math.floor(Math.round(i)/this.tile.lines)+"",col:Math.floor(Math.round(s)/this.tile.columns)+""};return{tile:l=l.line.padStart(3,"0")+"_"+l.col.padStart(3,"0"),line:Math.round(i)%this.tile.lines,col:Math.round(s)%this.tile.columns}},searchData(e,t,i){var s=this.changeFrame(t,i),l=this;return this.loadTile(e,s.tile).then((t=>(l.tiles[s.tile][e][s.line][s.col].forEach((function(t,i){l.tiles[s.tile][e][s.line][s.col][i]=parseFloat(t)})),{dimension:e,values:this.tiles[s.tile][e][s.line][s.col]})),(e=>!1))},computeCoordSystem(e){this.lines=e.properties.nb_lines,this.columns=e.properties.nb_columns,e.properties.tile&&(this.tile.lines=e.properties.tile.nb_lines,this.tile.columns=e.properties.tile.nb_columns),e.properties.images&&(this.images=e.properties.images),this.tileLines=Math.floor(this.lines/this.tile.lines),this.tileCols=Math.floor(this.columns/this.tile.columns);var t=e.properties.nb_lines-1,i=e.properties.nb_columns-1,s=e.properties.pointTL,l=e.properties.pointTR,n=e.properties.pointBL;this.coordSystem.origin={lat:s[1],lng:s[0]},this.coordSystem.u={dLat:(l[1]-s[1])/i,dLng:(l[0]-s[0])/i},this.coordSystem.v={dLat:(n[1]-s[1])/t,dLng:(n[0]-s[0])/t},this.determinant=this.coordSystem.u.dLng*this.coordSystem.v.dLat-this.coordSystem.u.dLat*this.coordSystem.v.dLng}};i(4812),delete s.Icon.Default.prototype._getIconUrl,s.Icon.Default.mergeOptions({iconRetinaUrl:i(7686),iconUrl:i(8061),shadowUrl:i(4014)});const h=L.ImageOverlay.Rotated.extend({max:null,type:"tio",dates:[],keys:[],images:[],searching:!1,legend:null,_marker:null,_polygon:null,_root:null,_image:null,_map:null,_ready:!1,_index:-1,options:{opacity:.7},getIndex(){return this._index>=0&&this._index},initialize(e){this._root=e;var t=this;a.load(this._root).then((e=>{t.initView(e)}))},onAdd(e){L.ImageOverlay.Rotated.prototype.onAdd.call(this,e),this._marker=L.marker([0,0]),this._marker.addTo(e),this._polygon.addTo(e);var t=this;this._marker.on("click",(function(e){t.searchData(e)})),this._polygon.on("click",(function(e){t.searchData(e)}))},onRemove(e){this._polygon.off("click"),this._polygon.remove(),this._marker.off("click"),this._marker.remove(),this.fire("TIO:RESET"),L.ImageOverlay.Rotated.prototype.onRemove.call(this,e)},isLoaded(){return this._ready},searchData(e){var t=this;this._marker.setLatLng(e.latlng),this.fire("TIO:RESET"),this.fire("TIO:SEARCHING",{searching:!0}),a.searchData("ew",e.latlng.lat,e.latlng.lng).then((e=>{t.fire("TIO:SEARCHING",{searching:!1}),e&&e.values&&null!==e.values[3]&&t.fire("TIO:DATA",e)})),a.searchData("ns",e.latlng.lat,e.latlng.lng).then((e=>{t.fire("TIO:SEARCHING",{searching:!1}),e&&e.values&&null!==e.values[3]&&t.fire("TIO:DATA",e)}))},initView(e){this.max=Math.max(e.properties.percentile_90_ew,e.properties.percentile_90_ns),this.dates=e.properties.dates.map((e=>n()(e,"YYYYMMDD").valueOf())),this.keys=e.properties.keys,this.images=e.properties.images,this.legend=this.images[0].legend,this._polygon=L.geoJSON(e,{style:()=>({weight:1,fillOpacity:.05,color:"blue"})}),L.ImageOverlay.Rotated.prototype.initialize.call(this,this.images[0].png,[e.properties.pointTL[1],e.properties.pointTL[0]],[e.properties.pointTR[1],e.properties.pointTR[0]],[e.properties.pointBL[1],e.properties.pointBL[0]],{opacity:.5}),this._ready=!0,this.fire("TIO:READY")}})},7686:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcY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"},4014:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=157.gdm-search-components-vjs.js.map